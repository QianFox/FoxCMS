/*
 * @Descripttion :
 * @Author       : liuzhifang
 * @Date         : 2022-01-11 17:44:50
 * @LastEditors  : QianFox Team
 * @LastEditTime : 2024-09-02 14:29:29
 */
tinymce.PluginManager.add('videosManager', function (editor) {
    var openVideosManager = function () {
        // 打开视频管理器
        foxui.videoManager.show('<div data-subid="tinymce"></div>');
        foxui.videoManager.onConfirm('tinymce', getVideo);

        // 获取图片并添加至富文本框中
        function getVideo(data) {
            // 将输入框内容插入到内容区光标位置
            editor.insertContent(
                `<video controls data-id="${data.choosedUrl}" src="${data.choosedUrl}"></video>`
            );
        }
    };

    // 注册一个工具栏按钮名称
    editor.ui.registry.addButton('videosManager', {
        icon: 'embed',
        tooltip: '选择视频',
        onAction: function () {
            openVideosManager();
        },
    });

    // 注册一个菜单项名称 menu/menubar
    editor.ui.registry.addMenuItem('videosManager', {
        text: '选择视频',
        icon: 'embed',
        onAction: function () {
            openVideosManager();
        },
    });

    return {
        getMetadata: function () {
            return {
                //插件名和链接会显示在“帮助”→“插件”→“已安装的插件”中
                name: 'videosManager plugin', //插件名称
                url: '', //作者网址
            };
        },
    };
});
